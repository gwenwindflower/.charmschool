# --- Basic Settings ---
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-kitty:RGB"
set -s extended-keys on
set -as terminal-features 'xterm-kitty:extkeys'
set -g mouse on
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on
set -sg escape-time 0
set-environment -g TMUX_PLUGIN_MANAGER_PATH '/Users/winnie/.config/tmux/plugins'

# Make the status line pretty and add some modules
set -g status-right-length 100
set -g status-left-length 100
set -g status-left ""
set -g status-right "#{E:@catppuccin_status_application}"
set -agF status-right "#{E:@catppuccin_status_cpu}"
set -ag status-right "#{E:@catppuccin_status_session}"
set -ag status-right "#{E:@catppuccin_status_uptime}"
set -agF status-right "#{E:@catppuccin_status_battery}"


# --- Vim-like Prefix ---
unbind C-b
set -g prefix C-f
bind C-f send-prefix

# --- Vim-like Pane Navigation ---
# bind h select-pane -L
# bind j select-pane -D
# bind k select-pane -U
# bind l select-pane -R
bind d kill-pane
bind C-q detach

bind n new-window -c "#{pane_current_path}"
bind C-M-h previous-window
bind C-M-l next-window

# --- Vim-like Splits ---
bind C-v split-window -h -c "#{pane_current_path}"
bind C-s split-window -v -c "#{pane_current_path}"

# --- Copy Mode (Vim-like) ---
setw -g mode-keys vi
bind [ copy-mode
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-pipe-and-cancel "pbcopy"

# --- Smart Navigation (Neovim aware) ---
# is_vim="ps -o state= -o comm= -t '#{pane_tty}' | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
# bind-key -n C-h if-shell "$is_vim" "send-keys C-h" "select-pane -L"
# bind-key -n C-j if-shell "$is_vim" "send-keys C-j" "select-pane -D"
# bind-key -n C-k if-shell "$is_vim" "send-keys C-k" "select-pane -U"
# bind-key -n C-l if-shell "$is_vim" "send-keys C-l" "select-pane -R"

# --- TPM Plugin Manager ---
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'alexwforsythe/tmux-which-key'
set -g @plugin 'tmux-plugins/tmux-battery'
set -g @plugin 'tmux-plugins/tmux-cpu'
set -g @plugin 'laktak/extrakto'
# set -g @plugin 'joshmedeski/tmux-nerd-font-window-name'
set -g @plugin 'christoomey/vim-tmux-navigator'
# --- Catppuccin Frappe Theme ---
set -g @plugin 'catppuccin/tmux'
set -g @catppuccin_flavour 'frappe'
set -g @catppuccin_window_status_style "rounded"
set -g @catppuccin_status_connect_separator "yes"
set -g @catppuccin_status_background "none"
set -g @catppuccin_status_module_bg_color "none"
run ~/.tmux/plugins/tmux/catppuccin.tmux
# --- Needs to stay last ---
run '/usr/local/share/tpm/tpm'
